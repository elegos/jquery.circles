/*global jQuery, Backbone, console*/

/**
*   jQuery Circle
*   by Giacomo Furlan <giacomo@giacomofurlan.name>
*   http://giacomofurlan.name
*
*   This plugin is under the Creative Commons 4.0 Attributions-ShareAlike Licence
*   http://creativecommons.org/licenses/by-sa/4.0/
*
*/
!function(t){"use strict";var r=Backbone.Model.extend({defaults:{radius:50,color:"#3498db",coord:{x:0,y:0},rendered:!1},initialize:function(){}});t.fn.circles=function(o){var e={circleColors:["#1abc9c","#27ae60","#3498db","#8e44ad","#34495e","#f1c40f","#f39c12","#d35400","#e74c3c","#bdc3c7","#7f8c8d"],radius:50},c=this,i=c.get(0).getContext("2d"),n=[],a=function(){t(n).each(function(){if(!this.attributes.rendered){var t=this.attributes;i.beginPath(),i.arc(t.coord.x,t.coord.y,t.radius,0,2*Math.PI,!1),i.fillStyle=t.color,i.fill(),i.closePath(),this.attributes.rendered=!0}})},d=function(t){var r="",o=0;do o=Math.floor(Math.random()*e.circleColors.length),r=e.circleColors[o];while(r===t&&e.circleColors.length>1);return r},u=function(o,c,i){var u="undefined"==typeof i?e.radius:i,s="";t(n).each(function(){var t=this.attributes;Math.pow(o-t.coord.x,2)+Math.pow(c-t.coord.y,2)<Math.pow(t.radius,2)&&(o=t.coord.x,c=t.coord.y,s=t.color,u=.8*t.radius)});var l=new r({color:d(s),coord:{x:o,y:c},radius:u});n.push(l),a()},s=function(){var r=n;n=[],i.clearRect(0,0,c.outerWidth(),c.outerHeight()),t(r).each(function(){u(this.attributes.coord.x,this.attributes.coord.y,this.attributes.radius)})},l=function(){return{addCircle:u,randomizeColors:s}};return t.extend(e,o),l()}}(jQuery);